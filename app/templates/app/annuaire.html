{% extends 'base.html' %}
{% load mptt_tags %}

{% block content %}
<div class="col col-sm-6 mx-auto">
    <h2 class="w-100 text-center mt-3">Annuaire</h2>
    <table class="table table-hover">
        {% for service in services %}
        <tr>
            <th colspan="4" class="table-primary">{{ service.name }}</th>
        </tr>
        <tr>
            <th>Nom</th>
            <th>PrÃ©nom</th>
            <th>â˜Ž Fixe</th>
            <th>ðŸ“± Mobile</th>
        </tr>
        {% for agent in service.agents.all|dictsort:"first_name"|dictsort:"last_name" %}
            {% if agent.role == 'Chef' %}
        <tr>
            <td>{{ agent.last_name }}</td>
            <td>{{ agent.first_name }}</td>
            <td>{% if agent.phone %}{{ agent.phone }}{% endif %}</td>
            <td>{% if agent.mobile %}{{ agent.mobile }}{% endif %}</td>
        </tr>
            {% endif %}
        {% endfor %}

        {% for agent in service.agents.all|dictsort:"first_name"|dictsort:"last_name" %}
            {% if agent.role == 'Adjoint' %}
        <tr>
            <td>{{ agent.last_name }}</td>
            <td>{{ agent.first_name }}</td>
            <td>{% if agent.phone %}{{ agent.phone }}{% endif %}</td>
            <td>{% if agent.mobile %}{{ agent.mobile }}{% endif %}</td>
        </tr>
            {% endif %}
        {% endfor %}

        {% for agent in service.agents.all|dictsort:"first_name"|dictsort:"last_name" %}
            {% if agent.role == 'SecrÃ©taire' %}
        <tr>
            <td>{{ agent.last_name }}</td>
            <td>{{ agent.first_name }}</td>
            <td>{% if agent.phone %}{{ agent.phone }}{% endif %}</td>
            <td>{% if agent.mobile %}{{ agent.mobile }}{% endif %}</td>
        </tr>
            {% endif %}
        {% endfor %}

        {% for agent in service.agents.all|dictsort:"first_name"|dictsort:"last_name" %}
            {% if agent.role == 'Autre' %}
        <tr>
            <td>{{ agent.last_name }}</td>
            <td>{{ agent.first_name }}</td>
            <td>{% if agent.phone %}{{ agent.phone }}{% endif %}</td>
            <td>{% if agent.mobile %}{{ agent.mobile }}{% endif %}</td>
        </tr>
            {% endif %}
        {% endfor %}

        {% endfor %}
    </table>
</div>
{% endblock %}