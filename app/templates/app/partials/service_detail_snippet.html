{% load mptt_tags %}

<div class="container">
    <div class="d-flex flex-wrap justify-content-evenly">
        {% for agent in service.agents.all|dictsort:"first_name"|dictsort:"last_name" %}
            {% if agent.role == 'Chef' %}
                {% include 'app/partials/agent_card_snippet.html' %}
            {% endif %}
        {% endfor %}
        {% for agent in service.agents.all|dictsort:"first_name"|dictsort:"last_name" %}
            {% if agent.role == 'Adjoint' %}
                {% include 'app/partials/agent_card_snippet.html' %}
            {% endif %}
        {% endfor %}
        {% for agent in service.agents.all|dictsort:"first_name"|dictsort:"last_name" %}
            {% if agent.role == 'Secr√©taire' %}
                {% include 'app/partials/agent_card_snippet.html' %}
            {% endif %}
        {% endfor %}
        {% for agent in service.agents.all|dictsort:"first_name"|dictsort:"last_name" %}
            {% if agent.role == 'Autre' %}
                {% include 'app/partials/agent_card_snippet.html' %}
            {% endif %}
        {% endfor %}
    </div>
</div>

{% recursetree service.children.all %}
    {% if node.children %}
        <div class="bg-light bg-gradient p-2 mb-3 h4 d-flex justify-content-between align-items-center">
            <nav aria-label="breadcrumb">
            <ol class="breadcrumb" style="--bs-breadcrumb-divider: '>';">
            {% for parent in node.get_parents %}
                <li class="breadcrumb-item">
                    <a href="{% url 'service' parent.id %}" class="d-none d-md-inline">{{ parent.name }}</a>
                </li>
            {% endfor %}
                <li class="breadcrumb-item"><a href="{% url 'service' node.id %}">{{ node.name }}</a></li>
            </ol>
            </nav>
            <a href="{% url 'annuaire' %}#service-{{ node.id }}" class="btn btn-primary mb-3"
               title="Annuaire {{ node.name }}">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-journal-text" viewBox="0 0 16 16">
                    <path d="M5 10.5a.5.5 0 0 1 .5-.5h2a.5.5 0 0 1 0 1h-2a.5.5 0 0 1-.5-.5zm0-2a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5zm0-2a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5zm0-2a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5z"/>
                    <path d="M3 0h10a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2v-1h1v1a1 1 0 0 0 1 1h10a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H3a1 1 0 0 0-1 1v1H1V2a2 2 0 0 1 2-2z"/>
                    <path d="M1 5v-.5a.5.5 0 0 1 1 0V5h.5a.5.5 0 0 1 0 1h-2a.5.5 0 0 1 0-1H1zm0 3v-.5a.5.5 0 0 1 1 0V8h.5a.5.5 0 0 1 0 1h-2a.5.5 0 0 1 0-1H1zm0 3v-.5a.5.5 0 0 1 1 0v.5h.5a.5.5 0 0 1 0 1h-2a.5.5 0 0 1 0-1H1z"/>
                </svg>
            </a>
        </div>
        {% include 'app/partials/service_detail_snippet.html' with service=node %}
    {% endif %}
{% endrecursetree %}